<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Xyloh.ai — Ask the Universe</title>
<style>
  :root{--bg:#0f0f12;--panel:#17171c;--line:#2a2a36;--text:#eef;--muted:#a8a8b6;--accent:#8a7bff;--accent2:#c08bff}
  *{box-sizing:border-box} body{margin:0;font-family:Inter,system-ui,Arial;background:radial-gradient(1200px 800px at 20% -10%,#1a1630,transparent),var(--bg);color:var(--text)}
  .wrap{max-width:900px;margin:0 auto;padding:22px}
  header{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px}
  .logo{display:block;width:220px;max-width:60vw}
  .card{background:var(--panel);border:1px solid var(--line);border-radius:16px;padding:16px}
  h1{margin:10px 0 4px;font-size:clamp(22px,5vw,34px)}
  p.hint{color:var(--muted);margin:0 0 12px}
  label{display:block;margin:10px 0 6px}
  input,textarea,select{width:100%;background:#1e1e26;color:#eef;border:1px solid var(--line);border-radius:10px;padding:12px;font-size:16px;outline:none}
  textarea{min-height:110px}
  .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
  .btn{background:linear-gradient(90deg,var(--accent),var(--accent2));color:#fff;border:none;padding:12px 16px;border-radius:12px;font-weight:900;cursor:pointer;box-shadow:0 8px 24px rgba(192,139,255,.28)}
  .btn.secondary{background:#21212a;border:1px solid var(--line);box-shadow:none}
  .output{background:#16161e;border:1px solid var(--line);border-radius:12px;padding:14px;margin-top:12px;white-space:pre-wrap;line-height:1.55;cursor:pointer}
  .output:hover{background:#1a1a24}
  .muted{color:var(--muted);font-size:12px}
  .meter{display:flex;align-items:center;gap:8px;margin-top:12px}
  .bar{flex:1;height:10px;background:#22232b;border:1px solid var(--line);border-radius:999px;overflow:hidden}
  .fill{height:100%;width:0%;background:linear-gradient(90deg,var(--accent),var(--accent2))}
  .count{font-size:12px;color:#d8d8e4;min-width:160px;text-align:right}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <svg class="logo" viewBox="0 0 720 120" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#8a7bff"/><stop offset="100%" stop-color="#c08bff"/></linearGradient></defs><text x="0" y="82" font-family="Inter, Arial, sans-serif" font-weight="900" font-size="72" fill="url(#g)">Xyloh.ai</text></svg>
  </header>

  <div class="card">
    <h1>Ask the Universe</h1>
    <p class="hint">Type a question. Xyloh blends reason + intuition to give a grounded, humane answer you can act on.</p>

    <div class="row">
      <div style="flex:1;min-width:180px">
        <label for="name">Your name (optional)</label>
        <input id="name" placeholder="e.g., Alex"/>
      </div>
      <div style="flex:1;min-width:180px">
        <label for="birth">Birth month/year (optional)</label>
        <input id="birth" placeholder="e.g., Oct 1990" />
      </div>
      <div style="flex:1;min-width:180px">
        <label for="tone">Tone</label>
        <select id="tone">
          <option value="supportive" selected>Supportive & Encouraging</option>
          <option value="direct">Direct & No‑nonsense</option>
          <option value="mystical">Mystical & Reflective</option>
          <option value="scientific">Scientific & Practical</option>
          <option value="playful">Playful & Light</option>
        </select>
      </div>
    </div>

    <label for="question">Your question</label>
    <textarea id="question" placeholder="What do you want clarity on today?" autofocus></textarea>

    <label for="context">Context / constraints (optional)</label>
    <textarea id="context" class="small" placeholder="Anything Xyloh should consider—timelines, people involved, resources, boundaries."></textarea>

    <div class="row">
      <button id="ask" class="btn">Ask Xyloh</button>
      <button id="reset" class="btn secondary">Reset</button>
    </div>

    <div id="status" class="muted" style="margin-top:8px"></div>
    <div id="out" class="output" style="display:none"></div>

    <div class="meter" aria-live="polite">
      <div class="bar"><div id="fill" class="fill"></div></div>
      <div id="counter" class="count">0 / 10 free today</div>
    </div>
    <p class="muted">Tip: click the answer to copy.</p>
  </div>
</div>

<script>
  const DAILY_LIMIT=10;
  const today=()=>{const d=new Date();return`xy_uses_${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;}
  const used=()=>Number(localStorage.getItem(today())||0);
  const bump=()=>{const k=today();localStorage.setItem(k,String(used()+1));meter();}
  const meter=()=>{const u=used();document.getElementById('fill').style.width=Math.min(100,Math.round((u/DAILY_LIMIT)*100))+'%';document.getElementById('counter').textContent=`${u} / ${DAILY_LIMIT} free today`;};
  meter();

  const askBtn=document.getElementById('ask');
  askBtn.onclick=async ()=>{
    const name=document.getElementById('name').value.trim();
    const birth=document.getElementById('birth').value.trim();
    const tone=document.getElementById('tone').value;
    const question=document.getElementById('question').value.trim();
    const context=document.getElementById('context').value.trim();
    if(!question) return alert('Please enter a question.');

    const status=document.getElementById('status');
    const out=document.getElementById('out');
    askBtn.disabled=true; askBtn.textContent='Listening…'; status.textContent='Asking Xyloh…'; out.style.display='none'; out.textContent='';

    try{
      const res=await fetch('/api/ask',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({name,birth,tone,question,context})});
      const data=await res.json();
      if(!res.ok) throw new Error(data.error||'Error');
      out.textContent = data.answer?.trim() || '(no answer)';
      out.style.display='block';
      out.onclick=async()=>{await navigator.clipboard.writeText(out.textContent); out.style.outline='2px solid #8a7bff'; setTimeout(()=>out.style.outline='none',700);}
      bump(); status.textContent='';
    }catch(e){
      out.style.display='block'; out.textContent='Error: '+e.message; status.textContent='Try again.';
    }finally{
      askBtn.disabled=false; askBtn.textContent='Ask Xyloh';
    }
  };

  document.getElementById('reset').onclick=()=>{
    ['name','birth','question','context'].forEach(id=>document.getElementById(id).value='');
    document.getElementById('tone').value='supportive';
    document.getElementById('out').style.display='none';
  };

  // Cmd/Ctrl+Enter submits
  document.addEventListener('keydown',e=>{if((e.metaKey||e.ctrlKey)&&e.key==='Enter') askBtn.click();});
</script>
</body>
</html>
